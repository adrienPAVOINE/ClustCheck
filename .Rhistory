#' @param object a object
#' @param var if you just want the Cramer for one varible
#'
#' @return
#' @export
#'
#' @examples
Vcramer.FactorDataset <- function(object, var = FALSE){
if(var == FALSE){
l<-c()
for (i in object$var.qual.names){
tableau <- table(object$data[[i]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
l <- c(l,cramer)
}
matrice = matrix(l,nrow=object$p.qual,ncol=1, dimnames = list(colnames(object$data.qual),"Cramer"))
print(matrice)
print(sapply(matrice, function(x) head(row.names(matrice)[order(x, decreasing = TRUE)], 3)))
}else{
tableau <- table(object$data[[var]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
cat("cramer entre la var groupe et ", var," = ", cramer)
}
}
Vcramer.FactorDataset(obj)
#' Vcramer.FactorDataset
#'
#' @param object a object
#' @param var if you just want the Cramer for one varible
#'
#' @return
#' @export
#'
#' @examples
Vcramer.FactorDataset <- function(object, var = FALSE){
if(var == FALSE){
l<-c()
for (i in object$var.qual.names){
tableau <- table(object$data[[i]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
l <- c(l,cramer)
}
matrice = matrix(l,nrow=object$p.qual,ncol=1, dimnames = list(colnames(object$data.qual),"Cramer"))
print(matrice)
sapply(matrice, function(x) head(row.names(matrice)[order(x, decreasing = TRUE)], 3))
}else{
tableau <- table(object$data[[var]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
cat("cramer entre la var groupe et ", var," = ", cramer)
}
}
Vcramer.FactorDataset(obj)
#' Vcramer.FactorDataset
#'
#' @param object a object
#' @param var if you just want the Cramer for one varible
#'
#' @return
#' @export
#'
#' @examples
Vcramer.FactorDataset <- function(object, var = FALSE){
if(var == FALSE){
l<-c()
for (i in object$var.qual.names){
tableau <- table(object$data[[i]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
l <- c(l,cramer)
}
matrice = matrix(l,nrow=object$p.qual,ncol=1, dimnames = list(colnames(object$data.qual),"Cramer"))
print(matrice)
sapply(matrice, function(Cramer) head(row.names(matrice)[order(Cramer, decreasing = TRUE)], 3))
}else{
tableau <- table(object$data[[var]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
cat("cramer entre la var groupe et ", var," = ", cramer)
}
}
Vcramer.FactorDataset(obj)
#' Vcramer.FactorDataset
#'
#' @param object a object
#' @param var if you just want the Cramer for one varible
#'
#' @return
#' @export
#'
#' @examples
Vcramer.FactorDataset <- function(object, var = FALSE){
if(var == FALSE){
l<-c()
for (i in object$var.qual.names){
tableau <- table(object$data[[i]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
l <- c(l,cramer)
}
matrice = matrix(l,nrow=object$p.qual,ncol=1, dimnames = list(colnames(object$data.qual),"Cramer"))
print(matrice)
print(rownames(matrice[which.max(matrice)]))
}else{
tableau <- table(object$data[[var]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
cat("cramer entre la var groupe et ", var," = ", cramer)
}
}
Vcramer.FactorDataset(obj)
#' Vcramer.FactorDataset
#'
#' @param object a object
#' @param var if you just want the Cramer for one varible
#'
#' @return
#' @export
#'
#' @examples
Vcramer.FactorDataset <- function(object, var = FALSE){
if(var == FALSE){
l<-c()
for (i in object$var.qual.names){
tableau <- table(object$data[[i]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
l <- c(l,cramer)
}
matrice = matrix(l,nrow=object$p.qual,ncol=1, dimnames = list(colnames(object$data.qual),"Cramer"))
print(matrice)
print(rownames(matrice[which.max(matrice[,1])]))
}else{
tableau <- table(object$data[[var]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
cat("cramer entre la var groupe et ", var," = ", cramer)
}
}
Vcramer.FactorDataset(obj)
matrice[which.max(matrice[,1])]
#' Vcramer.FactorDataset
#'
#' @param object a object
#' @param var if you just want the Cramer for one varible
#'
#' @return
#' @export
#'
#' @examples
Vcramer.FactorDataset <- function(object, var = FALSE){
if(var == FALSE){
l<-c()
for (i in object$var.qual.names){
tableau <- table(object$data[[i]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
l <- c(l,cramer)
}
matrice = matrix(l,nrow=object$p.qual,ncol=1, dimnames = list(colnames(object$data.qual),"Cramer"))
print(matrice)
print(head(sort(matrice[,1], decreasing = TRUE), 3))
}else{
tableau <- table(object$data[[var]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
cat("cramer entre la var groupe et ", var," = ", cramer)
}
}
matrice[which.max(matrice[,1])]
Vcramer.FactorDataset(obj)
#' Vcramer.FactorDataset
#'
#' @param object a object
#' @param var if you just want the Cramer for one varible
#'
#' @return
#' @export
#'
#' @examples
Vcramer.FactorDataset <- function(object, var = FALSE){
if(var == FALSE){
l<-c()
for (i in object$var.qual.names){
tableau <- table(object$data[[i]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
l <- c(l,cramer)
}
matrice = matrix(l,nrow=object$p.qual,ncol=1, dimnames = list(colnames(object$data.qual),"Cramer"))
print(matrice)
rownames(head(sort(matrice[,1], decreasing = TRUE), 3))
}else{
tableau <- table(object$data[[var]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
cat("cramer entre la var groupe et ", var," = ", cramer)
}
}
Vcramer.FactorDataset(obj)
#' Vcramer.FactorDataset
#'
#' @param object a object
#' @param var if you just want the Cramer for one varible
#'
#' @return
#' @export
#'
#' @examples
Vcramer.FactorDataset <- function(object, var = FALSE){
if(var == FALSE){
l<-c()
for (i in object$var.qual.names){
tableau <- table(object$data[[i]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
l <- c(l,cramer)
}
matrice = matrix(l,nrow=object$p.qual,ncol=1, dimnames = list(colnames(object$data.qual),"Cramer"))
print(matrice)
rownames(matrice)[head(sort(matrice[,1], decreasing = TRUE), 3)]
}else{
tableau <- table(object$data[[var]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
cat("cramer entre la var groupe et ", var," = ", cramer)
}
}
Vcramer.FactorDataset(obj)
#' Vcramer.FactorDataset
#'
#' @param object a object
#' @param var if you just want the Cramer for one varible
#'
#' @return
#' @export
#'
#' @examples
Vcramer.FactorDataset <- function(object, var = FALSE){
if(var == FALSE){
l<-c()
for (i in object$var.qual.names){
tableau <- table(object$data[[i]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
l <- c(l,cramer)
}
matrice = matrix(l,nrow=object$p.qual,ncol=1, dimnames = list(colnames(object$data.qual),"Cramer"))
print(matrice)
typeof(head(sort(matrice[,1], decreasing = TRUE), 3))
}else{
tableau <- table(object$data[[var]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
cat("cramer entre la var groupe et ", var," = ", cramer)
}
}
Vcramer.FactorDataset(obj)
#' Vcramer.FactorDataset
#'
#' @param object a object
#' @param var if you just want the Cramer for one varible
#'
#' @return
#' @export
#'
#' @examples
Vcramer.FactorDataset <- function(object, var = FALSE){
if(var == FALSE){
l<-c()
for (i in object$var.qual.names){
tableau <- table(object$data[[i]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
l <- c(l,cramer)
}
matrice = matrix(l,nrow=object$p.qual,ncol=1, dimnames = list(colnames(object$data.qual),"Cramer"))
print(matrice)
print(rownames(matrice(which(head(sort(matrice[,1], decreasing = TRUE), 3)))))
}else{
tableau <- table(object$data[[var]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
cat("cramer entre la var groupe et ", var," = ", cramer)
}
}
Vcramer.FactorDataset(obj)
#' Vcramer.FactorDataset
#'
#' @param object a object
#' @param var if you just want the Cramer for one varible
#'
#' @return
#' @export
#'
#' @examples
Vcramer.FactorDataset <- function(object, var = FALSE){
if(var == FALSE){
l<-c()
for (i in object$var.qual.names){
tableau <- table(object$data[[i]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
l <- c(l,cramer)
}
matrice = matrix(l,nrow=object$p.qual,ncol=1, dimnames = list(colnames(object$data.qual),"Cramer"))
print(matrice)
ind = head(sort(matrice[,1], decreasing = TRUE), 3)
rownames(matrice)[ind]
}else{
tableau <- table(object$data[[var]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
cat("cramer entre la var groupe et ", var," = ", cramer)
}
}
Vcramer.FactorDataset(obj)
#' Vcramer.FactorDataset
#'
#' @param object a object
#' @param var if you just want the Cramer for one varible
#'
#' @return
#' @export
#'
#' @examples
Vcramer.FactorDataset <- function(object, var = FALSE){
if(var == FALSE){
l<-c()
for (i in object$var.qual.names){
tableau <- table(object$data[[i]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
l <- c(l,cramer)
}
matrice = matrix(l,nrow=object$p.qual,ncol=1, dimnames = list(colnames(object$data.qual),"Cramer"))
print(matrice)
ind = head(sort(matrice[,1], decreasing = TRUE), 3)
print(ind)
rownames(matrice)[ind]
}else{
tableau <- table(object$data[[var]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
cat("cramer entre la var groupe et ", var," = ", cramer)
}
}
Vcramer.FactorDataset(obj)
#' @examples
#' Vcramer.FactorDataset
#'
#' @param object a object
#' @param var if you just want the Cramer for one varible
#'
#' @return
#' @export
#'
#' @examples
Vcramer.FactorDataset <- function(object, var = FALSE){
if(var == FALSE){
l<-c()
for (i in object$var.qual.names){
tableau <- table(object$data[[i]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
l <- c(l,cramer)
}
matrice = matrix(l,nrow=object$p.qual,ncol=1, dimnames = list(colnames(object$data.qual),"Cramer"))
print(matrice)
ind = head(sort(matrice[,1], decreasing = TRUE), 3)
print(ind[1,])
rownames(matrice)[ind]
}else{
tableau <- table(object$data[[var]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
cat("cramer entre la var groupe et ", var," = ", cramer)
}
}
Vcramer.FactorDataset(obj)
#' Vcramer.FactorDataset
#'
#' @param object a object
#' @param var if you just want the Cramer for one varible
#'
#' @return
#' @export
#'
#' @examples
Vcramer.FactorDataset <- function(object, var = FALSE){
if(var == FALSE){
l<-c()
for (i in object$var.qual.names){
tableau <- table(object$data[[i]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
l <- c(l,cramer)
}
matrice = matrix(l,nrow=object$p.qual,ncol=1, dimnames = list(colnames(object$data.qual),"Cramer"))
print(matrice)
ind = head(sort(matrice[,1], decreasing = TRUE), 3)
print(ind$rownames)
rownames(matrice)[ind]
}else{
tableau <- table(object$data[[var]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
cat("cramer entre la var groupe et ", var," = ", cramer)
}
}
Vcramer.FactorDataset(obj)
library(ClustCheck)
data <- read.csv("C:/Users/adrien/Documents/Test_data/BankCustomer.csv",sep=";", dec=",")
obj <- ClustCheck::FactoDataset(data, "Cluster")
PhiValueTable.FactorDataset(obj,"profession")
#' @examples
#' Vcramer.FactorDataset
#'
#' @param object a object
#' @param var if you just want the Cramer for one varible
#'
#' @return
#' @export
#'
#' @examples
Vcramer.FactorDataset <- function(object, var = FALSE){
if(var == FALSE){
l<-c()
for (i in object$var.qual.names){
tableau <- table(object$data[[i]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
l <- c(l,cramer)
}
matrice = matrix(l,nrow=object$p.qual,ncol=1, dimnames = list(colnames(object$data.qual),"Cramer"))
print(matrice)
listemax <- c()
ind = head(sort(matrice[,1], decreasing = TRUE), 3)
listemax <- c(listemax, ind)
print(listemax)
#rownames(matrice)[ind]
}else{
tableau <- table(object$data[[var]],object$data[[object$vargroupe]])
nli <- nrow(tableau)
nco <- ncol(tableau)
khi2 = chisq.test(tableau)$statistic
cramer = sqrt((khi2)/(nrow(object$data)*(min((nco-1),(nli-1)))))
cat("cramer entre la var groupe et ", var," = ", cramer)
}
}
Vcramer.FactorDataset(obj)
